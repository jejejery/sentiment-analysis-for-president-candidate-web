<section class="min-h-screen flex flex-col">
    <div class="pt-28 mx-auto">
      <a class="upload-item">Upload Your XLSX: </a><span>&nbsp;&nbsp;</span>
      <label class="file">
        <input type="file" id="file" aria-label="File browser example" accept = ".xlsx"  webkitdirectory (change)="onFolderSelected($event)">
        <span class="file-custom"></span>
      </label>
      <span>&nbsp;&nbsp;</span>
      <a class="upload-item">{{fileName}}</a>
    </div>
    <div  class="mt-10 mx-auto">
        <table *ngIf="isValid" mat-table [dataSource]="dataDisplay" class="mat-elevation-z8" style="width: 80%;">

            <!--- Note that these columns can be defined in any order.
                  The actual rendered columns are set as a property on the row definition" -->
          
            Position Column
            <ng-container matColumnDef="position">
              <th mat-header-cell *matHeaderCellDef> No. </th>
              <td mat-cell *matCellDef="let element"> {{element.position}} </td>
            </ng-container>
          
           
            <ng-container matColumnDef="kalimat">
              <th mat-header-cell *matHeaderCellDef> Kalimat </th>
              <td mat-cell *matCellDef="let element"> {{element.kalimat}} </td>
            </ng-container>
          
            
            <ng-container matColumnDef="aspect">
              <th mat-header-cell *matHeaderCellDef> aspek </th>
              <td mat-cell *matCellDef="let element"> {{element.aspect}} </td>
            </ng-container>
          
          
            <ng-container matColumnDef="opinion">
              <th mat-header-cell *matHeaderCellDef> Opini</th>
              <td mat-cell *matCellDef="let element"> {{element.opinion}} </td>
            </ng-container>

            <ng-container matColumnDef="true_tupple">
              <th mat-header-cell *matHeaderCellDef> True tupple</th>
              <td mat-cell *matCellDef="let element"> {{element.true_tupple}} </td>
            </ng-container>

            <ng-container matColumnDef="sentiment">
              <th mat-header-cell *matHeaderCellDef> Sentiment</th>
              <td mat-cell *matCellDef="let element"> {{element.sentiment}} </td>
            </ng-container>

            <ng-container matColumnDef="meta_aspect">
              <th mat-header-cell *matHeaderCellDef> Meta-aspect</th>
              <td mat-cell *matCellDef="let element"> {{element.meta_aspect}} </td>
            </ng-container>

            <ng-container matColumnDef="meta_opinion">
              <th mat-header-cell *matHeaderCellDef> Meta-opinion</th>
              <td mat-cell *matCellDef="let element"> {{element.meta_opinion}} </td>
            </ng-container>
          
          
            
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
          <h3 *ngIf="isInvalid" style="color: red;">Invalid Input!</h3>
    </div>  
    <div  class="pt-20 pb-30 mx-auto" style="margin-bottom: 30px;">
      <button mat-raised-button class="custom-button pt-28" color="primary" [disabled]="!isValid" (click)="downloadFile()">Export Graph</button>   
    </div>
          
</section>
